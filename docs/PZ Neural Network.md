СОГЛАСОВАНО
Доцент кафедры 
ИАНИ ННГУ, к.ф.-м.н.
_____________  Д.А. Яшунин
«____»______________2019 г.
	УТВЕРЖДАЮ
Профессор кафедры 
ИАНИ ННГУ, д.т.н.
_____________  Н.В. Старостин
«____»______________2019 г.

Пояснительная записка 
«Разработка модели нейронной сети для определения присутствия дронов на звуковой дорожке»

 НИР «Drone sound detection» 

(Шифр ПО «AFR»)



Ответственный исполнитель 

____________  Хромов Н.А.
«____»______________2019 г.




Н. Новгород 2019

Содержание
Введение	3
Наименование программы	3
Краткая характеристика области применения	3
Основания для разработки	3
Назначение разработки	3
Назначение ПО «CNN Drone sound detection» 	3
Результат решения	3
Требования к программному продукту	3
Требования к функциональным характеристикам	3
Требования к предварительным работам	3
Требования к разрабатываемому ПО	4
Общее описание алгоритма	4
Назначение алгоритма	4
Используемые библиотеки и модули	4
Входные данные	4
Описание алгоритма обучения рабочей версии нейронной сети 	5








 
1.	Введение
1.1 Наименование программы:
Наименование ПО «CNN Drone sound detection»

1.2 Краткая характеристика области применения
Объектом автоматизации является защита частной или государственной территории от несанкционированного вторжения. ПО «Drone sound detection» должно решать задачу по обнаружению дронов на основании звукового сигнала с определением их местоположения.
2.	Основания для разработки
Основание для выполнения ОКР: заказ конкретного потребителя.
Заказчик: Липкин С.
Исполнитель - Федеральное государственное автономное образовательное учреждение высшего образования «Нижегородский государственный университет им. Н. И. Лобачевского» (ННГУ)
Начало разработки - с момента заключения договора.
Окончание разработки - 30.06.2020
3.	Назначение разработки.
3.1 Назначение ПО «CNN Drone sound detection» 
Модель нейронной сети предназначена для определения с присутствия звуков дронов на звуковой дорожке с определенной вероятностью. 
3.2 Результат решения 
Результатом решения является обученная модель нейронной сети. 
4.	Требования к программному продукту 
4.1 Требование к функциональным характеристикам 
Модель нейронной сети должна обеспечивать возможность выполнения перечисленных ниже функций: 
1. Обнаружение присутствия дронов на звуковой дорожке. 
2. Определение точности предоставленного ответа.

4.2 Требования к предварительным работам 
В рамках создания ПО «CNN Drone sound detection» должно быть выполнено следующее: 
1. Формирование, поиск, модификация существующего датасета.
2. Ознакомление и выбор сущностей звукового сигнала, которые могут быть полезны для обучения сети. 

4.3 Требования к разрабатываемому ПО
В рамках создания ПО должно быть разработано следующее: 
1. Архитектура нейронной сети CNN 
2. Обученная модель нейронной сети.   

5.	Общее описание алгоритма 
5.1 Назначение алгоритма
Разработанный алгоритм служит для создания модели нейронной сети, способной дать ответ о наличии присутствия дрона на звуковой дорожке. 
5.1 Используемые библиотеки:
•	Librosa	– библиотека для работы со звуком. 
•	Pandas	– мощный пакет для анализа данных.
•	NumPy 	– это библиотека языка Python, добавляющая поддержку больших многомерных массивов и матриц, вместе с большой библиотекой высокоуровневых (и очень быстрых) математических функций для операций с этими массивами.
•	OS		– модуль из стандартной библиотеки языка Python, испульзуется для работы с установленной ОС, а также файловой системой ПК.
•	Matplotlib	– Библиотека на языке программирования Python для визуализации данных двумерной (2D) графикой. 
•	Pathlib	– Данный модуль упрощает работу с файлами и папками.
•	CVS		– Данный модуль даёт программисту возможность выполнять структурный анализ CVS файлов. 
•	Keras		– открытая нейросетевая библиотека. 
5.2	Входные данные:
Для обучения и тестирования нейронной сети использовался датасет из открытого репозитория: 
https://github.com/saraalemadi/DroneAudioDataset/tree/master/Binary_Drone_Audio



6.	Описание алгоритма обучения рабочей версии нейронной сети 
Импорт библиотек: 
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/1.png)
Извлечение сущностей из каждой звуковой дорожки из датасета:
Датасет содержит 2 класса: 
1. Есть дрон (1332 звуковые дорожки)
2. Нет дрона (1403 звуковые дорожки)
Извлечение спектрограмм для каждой звуковой дорожки: 
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/2.png)
Извлечение сущностей из спектрограмм
Мы будем извлекать:
•	Спектральный центроид
•	Частота перехода через нуль
•	Спектральная ширина 
•	Спектральный спад частоты 
•	Частота цветности
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/3.png)
 
Запись извлеченных данных в CVS файл:
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/4.png)
Анализ данных с помощью Pandas: 
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/5.png) 
Кодирование ярлыков
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/6.png)
Предобработка (масштабирование) данных для обучения
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/7.png)
Разделение данных на обучающий и тестовый набор
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/8.png)
Построение модели нейронной сети
	Настройка слоёв сети:
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/9.png)
	Настройка конфигурации обучения:
Прежде чем модель будет готова для обучения, нам нужно указать еще несколько параметров. Они добавляются на шаге compile модели:
•	Функция потерь (Loss function) — измеряет точность модели во время обучения. Мы хотим минимизировать эту функцию чтоб "направить" модель в верном направлении.
•	Оптимизатор (Optimizer) — показывает каким образом обновляется модель на основе входных данных и функции потерь.
•	Метрики (Metrics) — используются для мониторинга тренировки и тестирования модели. Наш пример использует метрику accuracy равную доле правильно классифицированных аудиодорожек.
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/10.png)
Обучение модели 
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/11.png)
При 40 эпохах обучения модель показывала наилучшие результаты. 
Проверка модели на тестовых данных 
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/12.png)
Сохранение обученной модели и предобработчика данных
![Image alt](https://github.com/Ann-Ageeva/Sound-recognition/tree/master/docs/PZImages/13.png)
В дальнейшем модель может быть использована для генерации предсказаний. 

Библиографический список
https://www.tensorflow.org/tutorials/keras/classification?hl=ru
https://gist.github.com/parulnith/7f8c174e6ac099e86f0495d3d9a4c01e#file-music_genre_classification-ipynb
	

   
    





